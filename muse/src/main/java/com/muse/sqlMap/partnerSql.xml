<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="com.muse.partner.mapper.partnerSql">
  
  <select id="selectActorName"  resultType="com.muse.partner.model.ActorDTO" parameterType="String">
  	select * from musical_actor where ma_name = #{ma_name}
  </select>

	<select id="selectMusicalList" parameterType="map" resultType="com.muse.partner.model.MusicalDTO">
    SELECT * FROM musical
    WHERE mh_code = #{mh_code}
    <if test="seachMusical != null and seachMusical != ''">
    AND m_title LIKE '%' || #{seachMusical} || '%'
	</if>
</select>

<select id="selectStartEndDate"  resultType="com.muse.partner.model.MusicalDTO" parameterType="String">
  select m_startDate, m_endDate  from musical where m_code = #{m_code}
  </select>
  
<insert id="insetMuscialDate" parameterType="map">
insert into musical_option values('mo_'||MUSICAL_OPTION_MO_CODE.nextval,#{m_code},#{mo_date},#{mo_time})
</insert>

<select id="selectOptionList"  resultType="com.muse.partner.model.MusicalOptionDTO" parameterType="String">
  select distinct mo_date from musical_option where m_code = #{m_code}
  </select>
  
<select id="selectTimeOptionList" resultType="com.muse.partner.model.MusicalOptionDTO" parameterType="map">
	select mo_time from musical_option where m_code = #{m_code} and mo_date = #{mo_date}
</select>

<insert id="insertCasting" parameterType="map">
insert into musical_casting values
('mc_'||MUSICAL_CASTING_MC_CODE.nextval,
#{ma_code},
(select mo_code 
from 
musical_option 
where mo_date = 
#{mo_date} and 
mo_time = #{mo_time} and 
m_code = #{m_code}),
#{mc_char})

</insert>
<insert id="insertTicketNotice" parameterType="map">
    insert into open_notice (
        on_code,
        m_code,
        rs_code,
        on_type,
        on_open,
        on_muse_open,
        on_info,
        on_sale,
        on_content,
        on_casting,
        on_img,
        on_etc,
        on_readnum,
        on_viewstate
    ) values (
        'on_' || OPEN_NOTICE_ON_CODE.nextval,
        #{m_code},
        #{rs_code},
        #{on_type},
        #{on_open},
        #{on_muse_open},
        #{on_info},
        #{on_sale},
        #{on_content},
        #{on_casting},
         (select m_detailimg from musical where m_code = #{m_code}),
        #{on_etc},
        0,
        0
    )
</insert>
  </mapper>